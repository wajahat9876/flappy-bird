{"version":3,"names":["Path1DEffectStyle","JsiDeclarationNode","NodeType","enumKey","processPath","composeDeclarations","PathEffectDeclaration","constructor","ctx","type","props","composeAndPush","pe1","save","decorateChildren","pe2","pathEffects","popAllAsOne","restore","pe","Skia","PathEffect","MakeCompose","push","DiscretePathEffectNode","DiscretePathEffect","decorate","length","deviation","seed","MakeDiscrete","Path2DPathEffectNode","Path2DPathEffect","matrix","path","MakePath2D","Error","DashPathEffectNode","DashPathEffect","intervals","phase","MakeDash","CornerPathEffectNode","CornerPathEffect","r","MakeCorner","SumPathEffectNode","SumPathEffect","pes","popAll","MakeSum","bind","Line2DPathEffectNode","Line2DPathEffect","width","MakeLine2D","Path1DPathEffectNode","Path1DPathEffect","advance","style","MakePath1D"],"sources":["PathEffects.ts"],"sourcesContent":["import { Path1DEffectStyle } from \"../../../skia/types\";\nimport type { SkPathEffect } from \"../../../skia/types\";\nimport type { NodeContext } from \"../Node\";\nimport { JsiDeclarationNode } from \"../Node\";\nimport type {\n  CornerPathEffectProps,\n  DashPathEffectProps,\n  DiscretePathEffectProps,\n  Line2DPathEffectProps,\n  Path1DPathEffectProps,\n  Path2DPathEffectProps,\n} from \"../../types\";\nimport { NodeType } from \"../../types\";\nimport { enumKey } from \"../datatypes/Enum\";\nimport { processPath } from \"../datatypes\";\nimport type { DeclarationContext } from \"../../types/DeclarationContext\";\nimport { composeDeclarations } from \"../../types/DeclarationContext\";\n\nabstract class PathEffectDeclaration<P> extends JsiDeclarationNode<P> {\n  constructor(ctx: NodeContext, type: NodeType, props: P) {\n    super(ctx, type, props);\n  }\n\n  protected composeAndPush(ctx: DeclarationContext, pe1: SkPathEffect) {\n    ctx.save();\n    this.decorateChildren(ctx);\n    const pe2 = ctx.pathEffects.popAllAsOne();\n    ctx.restore();\n    const pe = pe2 ? this.Skia.PathEffect.MakeCompose(pe1, pe2) : pe1;\n    ctx.pathEffects.push(pe);\n  }\n}\n\nexport class DiscretePathEffectNode extends PathEffectDeclaration<DiscretePathEffectProps> {\n  constructor(ctx: NodeContext, props: DiscretePathEffectProps) {\n    super(ctx, NodeType.DiscretePathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { length, deviation, seed } = this.props;\n    const pe = this.Skia.PathEffect.MakeDiscrete(length, deviation, seed);\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class Path2DPathEffectNode extends PathEffectDeclaration<Path2DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Path2DPathEffectProps) {\n    super(ctx, NodeType.Path2DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { matrix } = this.props;\n    const path = processPath(this.Skia, this.props.path);\n    const pe = this.Skia.PathEffect.MakePath2D(matrix, path);\n    if (pe === null) {\n      throw new Error(\"Path2DPathEffectNode: invalid path\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class DashPathEffectNode extends PathEffectDeclaration<DashPathEffectProps> {\n  constructor(ctx: NodeContext, props: DashPathEffectProps) {\n    super(ctx, NodeType.DashPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { intervals, phase } = this.props;\n    const pe = this.Skia.PathEffect.MakeDash(intervals, phase);\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class CornerPathEffectNode extends PathEffectDeclaration<CornerPathEffectProps> {\n  constructor(ctx: NodeContext, props: CornerPathEffectProps) {\n    super(ctx, NodeType.CornerPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { r } = this.props;\n    const pe = this.Skia.PathEffect.MakeCorner(r);\n    if (pe === null) {\n      throw new Error(\"CornerPathEffectNode: couldn't create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class SumPathEffectNode extends PathEffectDeclaration<null> {\n  constructor(ctx: NodeContext) {\n    super(ctx, NodeType.SumPathEffect, null);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    this.decorateChildren(ctx);\n    const pes = ctx.pathEffects.popAll();\n    const pe = composeDeclarations(\n      pes,\n      this.Skia.PathEffect.MakeSum.bind(this.Skia.PathEffect)\n    );\n    ctx.pathEffects.push(pe);\n  }\n}\n\nexport class Line2DPathEffectNode extends PathEffectDeclaration<Line2DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Line2DPathEffectProps) {\n    super(ctx, NodeType.Line2DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { width, matrix } = this.props;\n    const pe = this.Skia.PathEffect.MakeLine2D(width, matrix);\n    if (pe === null) {\n      throw new Error(\"Line2DPathEffectNode: could not create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class Path1DPathEffectNode extends PathEffectDeclaration<Path1DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Path1DPathEffectProps) {\n    super(ctx, NodeType.Path1DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { advance, phase, style } = this.props;\n    const path = processPath(this.Skia, this.props.path);\n    const pe = this.Skia.PathEffect.MakePath1D(\n      path,\n      advance,\n      phase,\n      Path1DEffectStyle[enumKey(style)]\n    );\n    if (pe === null) {\n      throw new Error(\"Path1DPathEffectNode: could not create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n"],"mappings":"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"}