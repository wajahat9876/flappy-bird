{"version":3,"names":["_types","require","_Node","_types2","_Enum","_datatypes","_DeclarationContext","PathEffectDeclaration","JsiDeclarationNode","constructor","ctx","type","props","composeAndPush","pe1","save","decorateChildren","pe2","pathEffects","popAllAsOne","restore","pe","Skia","PathEffect","MakeCompose","push","DiscretePathEffectNode","NodeType","DiscretePathEffect","decorate","length","deviation","seed","MakeDiscrete","exports","Path2DPathEffectNode","Path2DPathEffect","matrix","path","processPath","MakePath2D","Error","DashPathEffectNode","DashPathEffect","intervals","phase","MakeDash","CornerPathEffectNode","CornerPathEffect","r","MakeCorner","SumPathEffectNode","SumPathEffect","pes","popAll","composeDeclarations","MakeSum","bind","Line2DPathEffectNode","Line2DPathEffect","width","MakeLine2D","Path1DPathEffectNode","Path1DPathEffect","advance","style","MakePath1D","Path1DEffectStyle","enumKey"],"sources":["PathEffects.ts"],"sourcesContent":["import { Path1DEffectStyle } from \"../../../skia/types\";\nimport type { SkPathEffect } from \"../../../skia/types\";\nimport type { NodeContext } from \"../Node\";\nimport { JsiDeclarationNode } from \"../Node\";\nimport type {\n  CornerPathEffectProps,\n  DashPathEffectProps,\n  DiscretePathEffectProps,\n  Line2DPathEffectProps,\n  Path1DPathEffectProps,\n  Path2DPathEffectProps,\n} from \"../../types\";\nimport { NodeType } from \"../../types\";\nimport { enumKey } from \"../datatypes/Enum\";\nimport { processPath } from \"../datatypes\";\nimport type { DeclarationContext } from \"../../types/DeclarationContext\";\nimport { composeDeclarations } from \"../../types/DeclarationContext\";\n\nabstract class PathEffectDeclaration<P> extends JsiDeclarationNode<P> {\n  constructor(ctx: NodeContext, type: NodeType, props: P) {\n    super(ctx, type, props);\n  }\n\n  protected composeAndPush(ctx: DeclarationContext, pe1: SkPathEffect) {\n    ctx.save();\n    this.decorateChildren(ctx);\n    const pe2 = ctx.pathEffects.popAllAsOne();\n    ctx.restore();\n    const pe = pe2 ? this.Skia.PathEffect.MakeCompose(pe1, pe2) : pe1;\n    ctx.pathEffects.push(pe);\n  }\n}\n\nexport class DiscretePathEffectNode extends PathEffectDeclaration<DiscretePathEffectProps> {\n  constructor(ctx: NodeContext, props: DiscretePathEffectProps) {\n    super(ctx, NodeType.DiscretePathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { length, deviation, seed } = this.props;\n    const pe = this.Skia.PathEffect.MakeDiscrete(length, deviation, seed);\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class Path2DPathEffectNode extends PathEffectDeclaration<Path2DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Path2DPathEffectProps) {\n    super(ctx, NodeType.Path2DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { matrix } = this.props;\n    const path = processPath(this.Skia, this.props.path);\n    const pe = this.Skia.PathEffect.MakePath2D(matrix, path);\n    if (pe === null) {\n      throw new Error(\"Path2DPathEffectNode: invalid path\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class DashPathEffectNode extends PathEffectDeclaration<DashPathEffectProps> {\n  constructor(ctx: NodeContext, props: DashPathEffectProps) {\n    super(ctx, NodeType.DashPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { intervals, phase } = this.props;\n    const pe = this.Skia.PathEffect.MakeDash(intervals, phase);\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class CornerPathEffectNode extends PathEffectDeclaration<CornerPathEffectProps> {\n  constructor(ctx: NodeContext, props: CornerPathEffectProps) {\n    super(ctx, NodeType.CornerPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { r } = this.props;\n    const pe = this.Skia.PathEffect.MakeCorner(r);\n    if (pe === null) {\n      throw new Error(\"CornerPathEffectNode: couldn't create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class SumPathEffectNode extends PathEffectDeclaration<null> {\n  constructor(ctx: NodeContext) {\n    super(ctx, NodeType.SumPathEffect, null);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    this.decorateChildren(ctx);\n    const pes = ctx.pathEffects.popAll();\n    const pe = composeDeclarations(\n      pes,\n      this.Skia.PathEffect.MakeSum.bind(this.Skia.PathEffect)\n    );\n    ctx.pathEffects.push(pe);\n  }\n}\n\nexport class Line2DPathEffectNode extends PathEffectDeclaration<Line2DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Line2DPathEffectProps) {\n    super(ctx, NodeType.Line2DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { width, matrix } = this.props;\n    const pe = this.Skia.PathEffect.MakeLine2D(width, matrix);\n    if (pe === null) {\n      throw new Error(\"Line2DPathEffectNode: could not create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n\nexport class Path1DPathEffectNode extends PathEffectDeclaration<Path1DPathEffectProps> {\n  constructor(ctx: NodeContext, props: Path1DPathEffectProps) {\n    super(ctx, NodeType.Path1DPathEffect, props);\n  }\n\n  decorate(ctx: DeclarationContext) {\n    const { advance, phase, style } = this.props;\n    const path = processPath(this.Skia, this.props.path);\n    const pe = this.Skia.PathEffect.MakePath1D(\n      path,\n      advance,\n      phase,\n      Path1DEffectStyle[enumKey(style)]\n    );\n    if (pe === null) {\n      throw new Error(\"Path1DPathEffectNode: could not create path effect\");\n    }\n    this.composeAndPush(ctx, pe);\n  }\n}\n"],"mappings":"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"}